{% extends "base.html" %}

{% block title %}Query{% endblock %}
{% block sidebar %}
    <div class="col-md-4 col-sm-2">
        <div class="panel panel-default" >
            <div class="panel-heading">
                <h3 class="panel-title">Query help:</h3>
            </div>
            <div class="panel-body">
                <form id="query_api" method="post" action="/query/">
                    {% csrf_token %}
                    outputs:    <select>
                        {% for choice in query_api.outputs %}
                        <option name="outputs" value="{{ choice }}">{{ choice }}</option>
                        {% endfor %}
                    </select></br>
                    characters: <select>
                        {% for choice in query_api.characters %}
                        <option name="characters" value="{{ choice }}">{{ choice }}</option>
                        {% endfor %}
                    </select></br>
                    courses:    <select>
                        {% for choice in query_api.courses %}
                        <option name="courses" value="{{ choice }}">{{ choice }}</option>
                        {% endfor %}
                    </select></br>
                    fields:     <select>
                        {% for choice in query_api.fields %}
                        <option name="fields" value="{{ choice }}">{{ choice }}</option>
                        {% endfor %}
                    </select></br>
                    filters:    <select>
                        {% for choice in query_api.filters %}
                        <option name="filters" value="{{ choice }}">{{ choice }}</option>
                        {% endfor %}
                    </select></br>
                    <input type="submit" name="submit" value="Submit Query" />
                </form>
            </div>
            {% comment %}<div class="panel-body">
                <p>Please submit queries in the following form: </br>
                <p>[query_type] [modifier] [event] [subject]</br></br>
                <p>[query_type]: count, average, min, max, top, bottom</br>
                <p>[modifier]: on, with, per, by, less, more, lap, place</br>
                <p>[event]: Race, Session, Get, Use, Steal, Stolen, Passing, Passed, Start, Lap, Finish, Shortcut, Watch, Tag, Banana, Spin, Crash</br>
                <p>[subject]: options detailed below</br></br>
                <p>[players]: Bowser, DonkeyKong, Mario, Luigi, Peach, Toad, Yoshi</br>
                <p>[items]: Banana, BananaBunch, Boo, FakeItemBox, GreenShell, TripleGreenShells,
                          RedShell, TripleRedShells, BlueSpinyShell, Mushroom, TripleMushrooms,
                          GoldenMushroom, Star, Thunderbolt</br>
                <p>[courses]: LuigiCircuit, MooMooFarm, KoopaTroopaBeach, KalimariDesert, ToadsTurnpike,
                            FrappeSnowland, ChocoMountain, MarioRaceway, WarioStadium, SherbertLand,
                            RoyalRaceway, BowsersCastle, DKsJungleParkway, BansheeBoardwalk, RainbowRoad</br>
                
                        </div>{% endcomment %}
        </div>
    </div>      
{% endblock %}
{% block main %}
    {% if result_table %}
    <div class="col-md-5">
        {% if result_table.message %}
            <h3><i class="fa fa-warning"></i> Error:</h3>
            {{ result_table.message }}
        {% else %}
        <h3><i class="fa fa-trophy"></i> Results:</h3>
        <table class="table table-striped table-bordered table-condensed">
            {% for row in result_table.results %}
            <tr>
                {% for column in row %}
                    <td>{{ column }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
        <h3><i class="fa fa-question-circle"></i> Last Query:</h3>
        {{ result_table.query }}
        {% endif %}
    </div>
    <div class="col-md-5">
        <h3><i class="fa fa-search"></i> Please enter new query: </h3>
        <form id="query_form" method="post" action="/query/">
            {% csrf_token %}
            {% for hidden in form.hidden_fields %}
                {{ hidden }}
            {% endfor %}

            {{ form.as_p }}
            <input type="submit" name="submit" value="Submit Query" />
        </form>
    </div>
    {% else %}
    <div class="col-md-5">
        <h3><i class="fa fa-search"></i> Please enter query: </h3>
        <form id="query_form" method="post" action="/query/">
            {% csrf_token %}
            {% for hidden in form.hidden_fields %}
                {{ hidden }}
            {% endfor %}

            {{ form.as_p }}
            <input type="submit" name="submit" value="Submit Query" />
        </form>
    </div>
    {% endif %}
{% endblock %}
{% block js %}
    {% include "include/scripts.html" %}
    {% if result_table %}
    <link href="" rel="stylesheet">
    <script src=""></script>
    {% endif %}
{% endblock %}
